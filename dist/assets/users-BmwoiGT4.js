import{o as q,j as e,J as F,B as b,x as de,s as p,f as O,r as v,y as L,t as R,l as I,U as me,K as ue,a as P}from"./index-BFmsBeiJ.js";import{u as B,a as H,F as W,b as d,c as m,d as u,e as g,f as h,L as X}from"./form-CEOKA2cd.js";import{s as E}from"./show-submitted-data-BtM_jUFU.js";import{D as J,a as _,b as G,c as Y,d as Q,e as Z,f as he}from"./command-CDr2rerw.js";import{I as N}from"./input-D56alynu.js";import{P as k}from"./password-input-C4JvPeDM.js";import{S as ee,T as se,D as xe,a as pe,b as w,u as ge,c as je,j as fe,k as Ne,l as ve,m as A,n as be,o as M,p as we,q as $,r as ye,g as Ce,d as De,e as Se,f as Te,h as Pe,i as Re,s as x}from"./chunk-3WUZ46N3-BHjvuDag.js";import{A as ae,a as re,b as te}from"./alert-B4NHXP73.js";import{C as le,o as Fe,T as D,A as S,B as T}from"./confirm-dialog-fV3H9Ygp.js";import{T as Ue}from"./textarea-C3_NiCVS.js";import{M as Ae,a as Ie,U as Ee}from"./user-x-CPPu5Lp4.js";import{S as Ve}from"./send-DMMAuCQB.js";import{B as ke}from"./badge-Kr0hVYzQ.js";const Me=q({firstName:p().min(1,"First Name is required."),lastName:p().min(1,"Last Name is required."),username:p().min(1,"Username is required."),phoneNumber:p().min(1,"Phone number is required."),email:O({error:s=>s.input===""?"Email is required.":void 0}),password:p().transform(s=>s.trim()),role:p().min(1,"Role is required."),confirmPassword:p().transform(s=>s.trim()),isEdit:de()}).refine(s=>s.isEdit&&!s.password?!0:s.password.length>0,{message:"Password is required.",path:["password"]}).refine(({isEdit:s,password:a})=>s&&!a?!0:a.length>=8,{message:"Password must be at least 8 characters long.",path:["password"]}).refine(({isEdit:s,password:a})=>s&&!a?!0:/[a-z]/.test(a),{message:"Password must contain at least one lowercase letter.",path:["password"]}).refine(({isEdit:s,password:a})=>s&&!a?!0:/\d/.test(a),{message:"Password must contain at least one number.",path:["password"]}).refine(({isEdit:s,password:a,confirmPassword:r})=>s&&!a?!0:a===r,{message:"Passwords don't match.",path:["confirmPassword"]});function K({currentRow:s,open:a,onOpenChange:r}){const l=!!s,t=B({resolver:H(Me),defaultValues:l?{...s,password:"",confirmPassword:"",isEdit:l}:{firstName:"",lastName:"",username:"",email:"",role:"",phoneNumber:"",password:"",confirmPassword:"",isEdit:l}}),i=n=>{t.reset(),E(n),r(!1)},o=!!t.formState.dirtyFields.password;return e.jsx(J,{open:a,onOpenChange:n=>{t.reset(),r(n)},children:e.jsxs(_,{className:"sm:max-w-lg",children:[e.jsxs(G,{className:"text-start",children:[e.jsx(Y,{children:l?"Edit User":"Add New User"}),e.jsxs(Q,{children:[l?"Update the user here. ":"Create new user here. ","Click save when you're done."]})]}),e.jsx("div",{className:"h-[26.25rem] w-[calc(100%+0.75rem)] overflow-y-auto py-1 pe-3",children:e.jsx(W,{...t,children:e.jsxs("form",{id:"user-form",onSubmit:t.handleSubmit(i),className:"space-y-4 px-0.5",children:[e.jsx(d,{control:t.control,name:"firstName",render:({field:n})=>e.jsxs(m,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-end",children:"First Name"}),e.jsx(g,{children:e.jsx(N,{placeholder:"John",className:"col-span-4",autoComplete:"off",...n})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(d,{control:t.control,name:"lastName",render:({field:n})=>e.jsxs(m,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-end",children:"Last Name"}),e.jsx(g,{children:e.jsx(N,{placeholder:"Doe",className:"col-span-4",autoComplete:"off",...n})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(d,{control:t.control,name:"username",render:({field:n})=>e.jsxs(m,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-end",children:"Username"}),e.jsx(g,{children:e.jsx(N,{placeholder:"john_doe",className:"col-span-4",...n})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(d,{control:t.control,name:"email",render:({field:n})=>e.jsxs(m,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-end",children:"Email"}),e.jsx(g,{children:e.jsx(N,{placeholder:"john.doe@gmail.com",className:"col-span-4",...n})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(d,{control:t.control,name:"phoneNumber",render:({field:n})=>e.jsxs(m,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-end",children:"Phone Number"}),e.jsx(g,{children:e.jsx(N,{placeholder:"+123456789",className:"col-span-4",...n})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(d,{control:t.control,name:"role",render:({field:n})=>e.jsxs(m,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-end",children:"Role"}),e.jsx(ee,{defaultValue:n.value,onValueChange:n.onChange,placeholder:"Select a role",className:"col-span-4",items:F.map(({label:y,value:U})=>({label:y,value:U}))}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(d,{control:t.control,name:"password",render:({field:n})=>e.jsxs(m,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-end",children:"Password"}),e.jsx(g,{children:e.jsx(k,{placeholder:"e.g., S3cur3P@ssw0rd",className:"col-span-4",...n})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})}),e.jsx(d,{control:t.control,name:"confirmPassword",render:({field:n})=>e.jsxs(m,{className:"grid grid-cols-6 items-center space-y-0 gap-x-4 gap-y-1",children:[e.jsx(u,{className:"col-span-2 text-end",children:"Confirm Password"}),e.jsx(g,{children:e.jsx(k,{disabled:!o,placeholder:"e.g., S3cur3P@ssw0rd",className:"col-span-4",...n})}),e.jsx(h,{className:"col-span-4 col-start-3"})]})})]})})}),e.jsx(Z,{children:e.jsx(b,{type:"submit",form:"user-form",children:"Save changes"})})]})})}function $e({open:s,onOpenChange:a,currentRow:r}){const[l,t]=v.useState(""),i=()=>{l.trim()===r.productName&&(a(!1),E(r,"The following user has been deleted:"))};return e.jsx(le,{open:s,onOpenChange:a,handleConfirm:i,disabled:l.trim()!==r.productName,title:e.jsxs("span",{className:"text-destructive",children:[e.jsx(se,{className:"stroke-destructive me-1 inline-block",size:18})," ","Delete User"]}),desc:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"mb-2",children:["Are you sure you want to delete"," ",e.jsx("span",{className:"font-bold",children:r.productName}),"?",e.jsx("br",{}),"This action will permanently remove the user with the role of"," ",e.jsx("span",{className:"font-bold",children:r.role.toUpperCase()})," ","from the system. This cannot be undone."]}),e.jsxs(X,{className:"my-2",children:["Username:",e.jsx(N,{value:l,onChange:o=>t(o.target.value),placeholder:"Enter username to confirm deletion."})]}),e.jsxs(ae,{variant:"destructive",children:[e.jsx(re,{children:"Warning!"}),e.jsx(te,{children:"Please be careful, this operation can not be rolled back."})]})]}),confirmText:"Delete",destructive:!0})}const Ke=q({email:O({error:s=>s.input===""?"Please enter an email to invite.":void 0}),role:p().min(1,"Role is required."),desc:p().optional()});function ze({open:s,onOpenChange:a}){const r=B({resolver:H(Ke),defaultValues:{email:"",role:"",desc:""}}),l=t=>{r.reset(),E(t),a(!1)};return e.jsx(J,{open:s,onOpenChange:t=>{r.reset(),a(t)},children:e.jsxs(_,{className:"sm:max-w-md",children:[e.jsxs(G,{className:"text-start",children:[e.jsxs(Y,{className:"flex items-center gap-2",children:[e.jsx(Ae,{})," Invite User"]}),e.jsx(Q,{children:"Invite new user to join your team by sending them an email invitation. Assign a role to define their access level."})]}),e.jsx(W,{...r,children:e.jsxs("form",{id:"user-invite-form",onSubmit:r.handleSubmit(l),className:"space-y-4",children:[e.jsx(d,{control:r.control,name:"email",render:({field:t})=>e.jsxs(m,{children:[e.jsx(u,{children:"Email"}),e.jsx(g,{children:e.jsx(N,{type:"email",placeholder:"eg: john.doe@gmail.com",...t})}),e.jsx(h,{})]})}),e.jsx(d,{control:r.control,name:"role",render:({field:t})=>e.jsxs(m,{children:[e.jsx(u,{children:"Role"}),e.jsx(ee,{defaultValue:t.value,onValueChange:t.onChange,placeholder:"Select a role",items:F.map(({label:i,value:o})=>({label:i,value:o}))}),e.jsx(h,{})]})}),e.jsx(d,{control:r.control,name:"desc",render:({field:t})=>e.jsxs(m,{className:"",children:[e.jsx(u,{children:"Description (optional)"}),e.jsx(g,{children:e.jsx(Ue,{className:"resize-none",placeholder:"Add a personal note to your invitation (optional)",...t})}),e.jsx(h,{})]})})]})}),e.jsxs(Z,{className:"gap-y-2",children:[e.jsx(he,{asChild:!0,children:e.jsx(b,{variant:"outline",children:"Cancel"})}),e.jsxs(b,{type:"submit",form:"user-invite-form",children:["Invite ",e.jsx(Ve,{})]})]})]})})}const ne=L.createContext(null);function rs({children:s}){const[a,r]=Fe(null),[l,t]=v.useState(null);return e.jsx(ne,{value:{open:a,setOpen:r,currentRow:l,setCurrentRow:t},children:s})}const qe=()=>{const s=L.useContext(ne);if(!s)throw new Error("useUsers has to be used within <UsersContext>");return s};function ts(){const{open:s,setOpen:a,currentRow:r,setCurrentRow:l}=qe();return e.jsxs(e.Fragment,{children:[e.jsx(K,{open:s==="add",onOpenChange:()=>a("add")},"user-add"),e.jsx(ze,{open:s==="invite",onOpenChange:()=>a("invite")},"user-invite"),r&&e.jsxs(e.Fragment,{children:[e.jsx(K,{open:s==="edit",onOpenChange:()=>{a("edit"),setTimeout(()=>{l(null)},500)},currentRow:r},`user-edit-${r.id}`),e.jsx($e,{open:s==="delete",onOpenChange:()=>{a("delete"),setTimeout(()=>{l(null)},500)},currentRow:r},`user-delete-${r.id}`)]})]})}const C="DELETE";function Oe({open:s,onOpenChange:a,table:r}){const[l,t]=v.useState(""),i=r.getFilteredSelectedRowModel().rows,o=()=>{if(l.trim()!==C){R.error(`Please type "${C}" to confirm.`);return}a(!1),R.promise(I(2e3),{loading:"Deleting users...",success:()=>(r.resetRowSelection(),`Deleted ${i.length} ${i.length>1?"users":"user"}`),error:"Error"})};return e.jsx(le,{open:s,onOpenChange:a,handleConfirm:o,disabled:l.trim()!==C,title:e.jsxs("span",{className:"text-destructive",children:[e.jsx(se,{className:"stroke-destructive me-1 inline-block",size:18})," ","Delete ",i.length," ",i.length>1?"users":"user"]}),desc:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"mb-2",children:["Are you sure you want to delete the selected users? ",e.jsx("br",{}),"This action cannot be undone."]}),e.jsxs(X,{className:"my-4 flex flex-col items-start gap-1.5",children:[e.jsxs("span",{className:"",children:['Confirm by typing "',C,'":']}),e.jsx(N,{value:l,onChange:n=>t(n.target.value),placeholder:`Type "${C}" to confirm.`})]}),e.jsxs(ae,{variant:"destructive",children:[e.jsx(re,{children:"Warning!"}),e.jsx(te,{children:"Please be careful, this operation can not be rolled back."})]})]}),confirmText:"Delete",destructive:!0})}function Le({table:s}){const[a,r]=v.useState(!1),l=s.getFilteredSelectedRowModel().rows,t=o=>{const n=l.map(y=>y.original);R.promise(I(2e3),{loading:`${o==="active"?"Activating":"Deactivating"} users...`,success:()=>(s.resetRowSelection(),`${o==="active"?"Activated":"Deactivated"} ${n.length} user${n.length>1?"s":""}`),error:`Error ${o==="active"?"activating":"deactivating"} users`}),s.resetRowSelection()},i=()=>{const o=l.map(n=>n.original);R.promise(I(2e3),{loading:"Inviting users...",success:()=>(s.resetRowSelection(),`Invited ${o.length} user${o.length>1?"s":""}`),error:"Error inviting users"}),s.resetRowSelection()};return e.jsxs(e.Fragment,{children:[e.jsxs(xe,{table:s,entityName:"user",children:[e.jsxs(D,{children:[e.jsx(S,{asChild:!0,children:e.jsxs(b,{variant:"outline",size:"icon",onClick:i,className:"size-8","aria-label":"Invite selected users",title:"Invite selected users",children:[e.jsx(Ie,{}),e.jsx("span",{className:"sr-only",children:"Invite selected users"})]})}),e.jsx(T,{children:e.jsx("p",{children:"Invite selected users"})})]}),e.jsxs(D,{children:[e.jsx(S,{asChild:!0,children:e.jsxs(b,{variant:"outline",size:"icon",onClick:()=>t("active"),className:"size-8","aria-label":"Activate selected users",title:"Activate selected users",children:[e.jsx(me,{}),e.jsx("span",{className:"sr-only",children:"Activate selected users"})]})}),e.jsx(T,{children:e.jsx("p",{children:"Activate selected users"})})]}),e.jsxs(D,{children:[e.jsx(S,{asChild:!0,children:e.jsxs(b,{variant:"outline",size:"icon",onClick:()=>t("inactive"),className:"size-8","aria-label":"Deactivate selected users",title:"Deactivate selected users",children:[e.jsx(Ee,{}),e.jsx("span",{className:"sr-only",children:"Deactivate selected users"})]})}),e.jsx(T,{children:e.jsx("p",{children:"Deactivate selected users"})})]}),e.jsxs(D,{children:[e.jsx(S,{asChild:!0,children:e.jsxs(b,{variant:"destructive",size:"icon",onClick:()=>r(!0),className:"size-8","aria-label":"Delete selected users",title:"Delete selected users",children:[e.jsx(pe,{}),e.jsx("span",{className:"sr-only",children:"Delete selected users"})]})}),e.jsx(T,{children:e.jsx("p",{children:"Delete selected users"})})]})]}),e.jsx(Oe,{table:s,open:a,onOpenChange:r})]})}const z=[{accessorKey:"productName",header:({column:s})=>e.jsx(w,{column:s,title:"Nama Produk"}),cell:({row:s})=>e.jsx("div",{className:"w-fit ps-2 text-nowrap",children:s.getValue("productName")})},{accessorKey:"productCode",header:({column:s})=>e.jsx(w,{column:s,title:"Kode Produk"}),cell:({row:s})=>e.jsx("div",{className:"w-fit ps-2 text-nowrap",children:s.getValue("productCode")})},{accessorKey:"providerName",header:({column:s})=>e.jsx(w,{column:s,title:"Provider"}),cell:({row:s})=>e.jsx("div",{className:"w-fit ps-2 text-nowrap",children:s.getValue("providerName")})},{accessorKey:"price",header:({column:s})=>e.jsx(w,{column:s,title:"Harga"}),cell:({row:s})=>{const a=s.getValue("price");return e.jsx("div",{children:`Rp ${a.toLocaleString("id-ID")}`})},enableSorting:!1},{accessorKey:"role",header:({column:s})=>e.jsx(w,{column:s,title:"Type"}),cell:({row:s})=>{const{role:a}=s.original,r=F.find(({value:l})=>l===a);return r?e.jsxs("div",{className:"flex items-center gap-x-2",children:[r.icon&&e.jsx(r.icon,{size:16,className:"text-muted-foreground"}),e.jsx("span",{className:"text-sm capitalize",children:s.getValue("role")})]}):null},filterFn:(s,a,r)=>r.includes(s.getValue(a)),enableSorting:!1,enableHiding:!1},{accessorKey:"status",header:({column:s})=>e.jsx(w,{column:s,title:"Status"}),cell:({row:s})=>{const{status:a}=s.original,r=ue.get(a);return e.jsx("div",{className:"flex space-x-2",children:e.jsx(ke,{variant:"outline",className:P("capitalize",r),children:s.getValue("status")})})},filterFn:(s,a,r)=>r.includes(s.getValue(a)),enableHiding:!1,enableSorting:!1}];function ls({data:s,search:a,navigate:r}){const[l,t]=v.useState({}),[i,o]=v.useState({}),[n,y]=v.useState([]),{columnFilters:U,onColumnFiltersChange:oe,pagination:ie,onPaginationChange:ce,ensurePageInRange:V}=ge({search:a,navigate:r,pagination:{defaultPage:1,defaultPageSize:10},globalFilter:{enabled:!1},columnFilters:[{columnId:"username",searchKey:"username",type:"string"},{columnId:"status",searchKey:"status",type:"array"},{columnId:"role",searchKey:"role",type:"array"}]}),j=je({data:s,columns:z,state:{sorting:n,pagination:ie,rowSelection:l,columnFilters:U,columnVisibility:i},enableRowSelection:!0,onPaginationChange:ce,onColumnFiltersChange:oe,onRowSelectionChange:t,onSortingChange:y,onColumnVisibilityChange:o,getPaginationRowModel:Re(),getCoreRowModel:Pe(),getFilteredRowModel:Te(),getSortedRowModel:Se(),getFacetedRowModel:De(),getFacetedUniqueValues:Ce()});return v.useEffect(()=>{V(j.getPageCount())},[j,V]),e.jsxs("div",{className:P('max-sm:has-[div[role="toolbar"]]:mb-16',"flex flex-1 flex-col gap-4"),children:[e.jsx(fe,{table:j,searchPlaceholder:"Cari Produk",searchKey:"",filters:[{columnId:"status",title:"Status",options:[{label:"open",value:"open"},{label:"gangguan",value:"gangguan"},{label:"closed",value:"closed"}]},{columnId:"role",title:"Type",options:F.map(f=>({...f}))}]}),e.jsx("div",{className:"overflow-hidden rounded-md border",children:e.jsxs(Ne,{children:[e.jsx(ve,{children:j.getHeaderGroups().map(f=>e.jsx(A,{className:"group/row",children:f.headers.map(c=>e.jsx(be,{colSpan:c.colSpan,className:P("bg-background group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted",c.column.columnDef.meta?.className,c.column.columnDef.meta?.thClassName),children:c.isPlaceholder?null:M(c.column.columnDef.header,c.getContext())},c.id))},f.id))}),e.jsx(we,{children:j.getRowModel().rows?.length?j.getRowModel().rows.map(f=>e.jsx(A,{"data-state":f.getIsSelected()&&"selected",className:"group/row",children:f.getVisibleCells().map(c=>e.jsx($,{className:P("bg-background group-hover/row:bg-muted group-data-[state=selected]/row:bg-muted",c.column.columnDef.meta?.className,c.column.columnDef.meta?.tdClassName),children:M(c.column.columnDef.cell,c.getContext())},c.id))},f.id)):e.jsx(A,{children:e.jsx($,{colSpan:z.length,className:"h-24 text-center",children:"No results."})})})]})}),e.jsx(ye,{table:j,className:"mt-auto"}),e.jsx(Le,{table:j})]})}x.seed(67890);const ns=Array.from({length:500},()=>{const s=x.helpers.arrayElement(["TELKOMSEL","XL","INDOSAT","AXIS","TRI","SMARTFREN","PLN","GOPAY","OVO","DANA"]),a=x.helpers.arrayElement(["5K","10K","20K","25K","50K","100K"]),r=`${s}${a}`,l=`${s} ${a} Pulsa`;return{id:x.string.uuid(),productName:l,productCode:r,providerName:s,price:x.number.int({min:5e3,max:1e5}),status:x.helpers.arrayElement(["open","gangguan","closed"]),role:x.helpers.arrayElement(["topup","ppob","qty"]),createdAt:x.date.past(),updatedAt:x.date.recent()}});export{rs as U,ls as a,ts as b,qe as c,ns as u};
